# ===========================================================================
# JEPA Benchmark -- ImageNet-1K Full Evaluation
# ===========================================================================
# Settings optimised for large-scale ImageNet-1K evaluation.
#   - Larger batch sizes for faster feature extraction.
#   - k-NN k values tuned for the 1000-class setting (k=20 is standard).
#   - Full linear-probe LR sweep with 90 epochs (common ImageNet protocol).
#   - Fine-tuning enabled by default with standard hyperparameters.
# ===========================================================================

# ---------------------------------------------------------------------------
# General settings
# ---------------------------------------------------------------------------
seed: 42
device: "auto"  # auto, cuda, mps, cpu
num_workers: 8
output_dir: "./results/imagenet1k"
cache_dir: "./cache/features"
wandb:
  enabled: true
  project: "jepa-benchmark"
  entity: null

# ---------------------------------------------------------------------------
# Dataset settings
# ---------------------------------------------------------------------------
datasets:
  data_root: "./data"
  primary: "imagenet1k"
  image_size: 224
  batch_size: 512

# ---------------------------------------------------------------------------
# Models to evaluate
# ---------------------------------------------------------------------------
models:
  - name: "dinov2"
    arch: "vit_base"
    checkpoint: null
  - name: "dinov1"
    arch: "vit_base"
    checkpoint: null
  - name: "mae"
    arch: "vit_base"
    checkpoint: null
  - name: "ijepa"
    arch: "vit_huge"
    checkpoint: null
  - name: "ibot"
    arch: "vit_base"
    checkpoint: null
  - name: "lejepa"
    arch: "vit_huge"
    checkpoint: null

# ---------------------------------------------------------------------------
# Evaluation protocols
# ---------------------------------------------------------------------------
evaluation:
  knn:
    enabled: true
    k_values: [10, 20, 50]
    temperature: 0.07

  linear_probe:
    enabled: true
    lr_sweep: [0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 1.0, 3.0, 10.0]
    epochs: 90
    batch_size: 512
    optimizer: "sgd"
    momentum: 0.9
    weight_decay: 0.0
    lr_schedule: "cosine"
    normalize_features: true

  quick_linear_probe:
    enabled: true
    C_values: [0.001, 0.01, 0.1, 1.0, 10.0, 100.0]

  finetune:
    enabled: true
    lr: 0.001
    weight_decay: 0.05
    epochs: 100
    batch_size: 64
    layer_decay: 0.65
    warmup_epochs: 10

  low_shot:
    enabled: true
    percentages: [0.01, 0.1]
